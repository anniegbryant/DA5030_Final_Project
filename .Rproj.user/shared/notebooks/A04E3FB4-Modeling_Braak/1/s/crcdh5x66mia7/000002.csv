"0","# Print kNN model summary"
"0","ensemble.models$knn"
"1","k-Nearest Neighbors"
"1"," "
"1","

"
"1","246"
"1",""
"1"," samples"
"1","
"
"1","  8"
"1",""
"1"," predictor"
"1",""
"1","
"
"1","
"
"1","Pre-processing: centered (8), scaled (8)"
"1"," "
"1","
"
"1","Resampling:"
"1"," "
"1","Cross-Validated (10 fold)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","221, 222, 221, 222, 222, 221, ..."
"1"," "
"1","
"
"1","Resampling results"
"1"," across tuning parameters"
"1",":

"
"1",""
"1","  k "
"1","  RMSE    "
"1","  Rsquared  "
"1","  MAE      "
"1","
"
"1","   5"
"1","  1.120773"
"1","  0.06504781"
"1","  0.6403447"
"1","
"
"1","   7"
"1","  1.093394"
"1","  0.09410247"
"1","  0.6171815"
"1","
"
"1","   9"
"1","  1.093860"
"1","  0.09164270"
"1","  0.6121086"
"1","
"
"1","  11"
"1","  1.086458"
"1","  0.09391651"
"1","  0.6068529"
"1","
"
"1","  13"
"1","  1.083116"
"1","  0.08530821"
"1","  0.6133156"
"1","
"
"1","  15"
"1","  1.077681"
"1","  0.07641652"
"1","  0.6079703"
"1","
"
"1","  17"
"1","  1.084270"
"1","  0.06134540"
"1","  0.6074644"
"1","
"
"1","  19"
"1","  1.083972"
"1","  0.05216930"
"1","  0.6048986"
"1","
"
"1","  21"
"1","  1.081430"
"1","  0.05344155"
"1","  0.6020657"
"1","
"
"1","  23"
"1","  1.081091"
"1","  0.05389690"
"1","  0.5982601"
"1","
"
"1","  25"
"1","  1.079508"
"1","  0.05551884"
"1","  0.5908098"
"1","
"
"1","  27"
"1","  1.075542"
"1","  0.05496167"
"1","  0.5890638"
"1","
"
"1","  29"
"1","  1.080152"
"1","  0.05017409"
"1","  0.5946808"
"1","
"
"1","  31"
"1","  1.080753"
"1","  0.05341816"
"1","  0.5924494"
"1","
"
"1","  33"
"1","  1.079678"
"1","  0.04947655"
"1","  0.5931427"
"1","
"
"1","  35"
"1","  1.077290"
"1","  0.05216163"
"1","  0.5931585"
"1","
"
"1","  37"
"1","  1.074941"
"1","  0.05633062"
"1","  0.5925222"
"1","
"
"1","  39"
"1","  1.070938"
"1","  0.06979628"
"1","  0.5903067"
"1","
"
"1","  41"
"1","  1.074376"
"1","  0.06747025"
"1","  0.5940953"
"1","
"
"1","  43"
"1","  1.074941"
"1","  0.06025386"
"1","  0.5954501"
"1","
"
"1","
"
"1","RMSE was used to select the optimal model using the smallest value.
"
"1","The final value used for the model was k = 39."
"1","
"
"0","# kNN cross-validation plot"
"0","knn.k <- ensemble.models$knn$results$k"
"0","knn.rmse <- ensemble.models$knn$results$RMSE"
"0","knn.mae <- ensemble.models$knn$results$MAE"
"0",""
"0","# Plot the RMSE and MAE in a facet plot using facet_wrap"
"0","p.knn.cv <- data.frame(k=knn.k, RMSE=knn.rmse, MAE=knn.mae) %>%"
"0","  pivot_longer(cols=c(RMSE, MAE), names_to=""Metric"", values_to=""Value"") %>%"
"0","  mutate(Metric = ifelse(Metric==""MAE"", ""Mean Absolute Error"", ""Root-Mean Square Error"")) %>%"
"0","  # One line per value of alpha"
"0","  ggplot(data=., mapping=aes(x=k, y=Value, color=Metric)) +"
"0","  # Facet the MAE and RMSE in separate plots"
"0","  facet_wrap(Metric ~ ., scales=""free"") +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  theme_minimal() +"
"0","  ggtitle(""kNN Regression Cross-Validated Results"") +"
"0","  theme(plot.title=element_text(hjust=0.5),"
"0","        axis.title=element_blank(),"
"0","        panel.spacing = unit(2, ""lines""))"
"0",""
"0","# Convert to interactive plotly"
"0","ggplotly(p.knn.cv) %>% "
"0","  layout(yaxis = list(title = ""MAE"", "
"0","                      titlefont = list(size = 12)),"
"0","         xaxis = list(title = ""k"", "
"0","                      titlefont = list(size = 12)),"
"0","         yaxis2 = list(title = ""RMSE"", "
"0","                       titlefont = list(size = 12)),"
"0","         xaxis2 = list(title = ""k"", "
"0","                       titlefont = list(size = 12)),"
"0","         autosize = F, width = 900, height = 400)"
