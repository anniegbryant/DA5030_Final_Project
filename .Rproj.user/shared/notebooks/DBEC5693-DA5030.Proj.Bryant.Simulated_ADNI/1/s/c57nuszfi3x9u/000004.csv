"0",""
"0","p.r2 <- model.metrics.full %>%"
"0","  # Plot the R2 for test data predictions"
"0","  filter(Data==""Test"", Metric==""R2"") %>%"
"0","  # Show models in specific order on x-axis"
"0","  mutate(Model=factor(Model, levels=c(""ensemble.glmnet"", ""ensemble.glm"", ""ensemble.rf"", ""elastic.net"", ""knn"", ""neural.net"", ""random.forest""))) %>%"
"0","  ggplot(data=., mapping=aes(x=Model, y=Value, fill=ROI_Type)) +"
"0","  geom_bar(stat=""identity"", position=position_dodge()) +"
"0","  labs(fill=""ROI Type"") +"
"0","  theme_minimal() +"
"0","  ggtitle(""R2 Between Predicted vs. Actual CDR-SoB"") +"
"0","  # Use pre-defined color palette"
"0","  scale_fill_manual(values=r2.pal) +"
"0","  ylab(""R2"") +"
"0","  theme(axis.text.x = element_text(angle=45, hjust=1),"
"0","        plot.title=element_text(hjust=0.5),"
"0","        strip.text = element_text(size=12, face=""bold""),"
"0","        legend.position = ""bottom"")"
"0","ggplotly(p.r2, width=700, height=300)"
