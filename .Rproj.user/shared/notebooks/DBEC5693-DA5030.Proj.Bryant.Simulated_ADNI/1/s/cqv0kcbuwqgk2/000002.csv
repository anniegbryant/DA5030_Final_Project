"0","# Convert correlation matrix from wide --> long, each row will detail one pairwise correlation"
"0","roi.cor.long <-  as.data.frame(roi.cor) %>%"
"0","  rownames_to_column(var=""ROI1"") %>%"
"0","  pivot_longer(cols=c(-ROI1), names_to=""ROI2"", values_to=""Pearson_Corr"") %>%"
"0","  # Exclude rows where the two ROIs are the same, where correlation is always 1"
"0","  filter(ROI1 != ROI2) %>%"
"0","  # Join with Braak-stage stratification dataframe by the first ROI column"
"0","  left_join(., roi.braak, by=c(""ROI1""=""Base_Name"")) %>%"
"0","  select(-ROI_Name, -Hemisphere) %>%"
"0","  # Specify that Braak + Cortex info pertain to the first ROI column, not the second"
"0","  dplyr::rename(""ROI1_Braak"" = ""Braak"", ""ROI1_Cortex"" = ""Cortex"") %>%"
"0","  # Merge again with Braak-stage stratification, this time by the second ROI column"
"0","  left_join(., roi.braak, by=c(""ROI2"" = ""Base_Name"")) %>%"
"0","  select(-ROI_Name, -Hemisphere) %>%"
"0","  dplyr::rename(""ROI2_Braak"" = ""Braak"", ""ROI2_Cortex"" = ""Cortex"") %>%"
"0","  # Rename Insula as Ins for visualization purpose"
"0","  mutate_at(c(""ROI1_Cortex"", ""ROI2_Cortex""), function(x) ifelse(x==""Insula"", ""Ins"", x))"
"0",""
"0","# Plot the correlation by Cortical Lobe"
"0","p.cor.cortical <- roi.cor.long %>%"
"0","  ggplot(., mapping=aes(x=ROI1, y=ROI2)) +"
"0","  # Heatmap, fill squares by pearson correlation coefficient"
"0","  geom_tile(mapping=aes(fill=Pearson_Corr)) +"
"0","  labs(fill=""Pearson Coefficient"") +"
"0","  theme_minimal() +"
"0","  # Facet by cortical lobes"
"0","  facet_grid(ROI2_Cortex ~ ROI1_Cortex, scales=""free"", "
"0","             space=""free"", switch=""both"") +"
"0","  ggtitle(""Correlation in Annual Tau SUVR Change by Cortical Lobe"") +"
"0","  theme(axis.title=element_blank(),"
"0","        axis.text.y = element_text(size=11),"
"0","        axis.text.x = element_text(angle=90, size=11, hjust=1),"
"0","        panel.border = element_blank(), "
"0","        panel.grid = element_blank(),"
"0","        plot.title=element_text(hjust=0.5)) +"
"0","  theme(strip.placement = ""outside"") +"
"0","  scale_fill_gradient2(low=""#210DFC"", mid=""white"", high=""#FF171B"","
"0","                       limits=c(-1,1))"
"0",""
"0","# Save correlation matrix to PNG and print -- dimensions were bizarre if I plotted directly from ggplot"
"0","ggsave(""ROI_Correlation_Cortical.png"", plot=p.cor.cortical, width=9, height=7.5, units=""in"", dpi=300)"
"0","include_graphics(""ROI_Correlation_Cortical.png"")"
