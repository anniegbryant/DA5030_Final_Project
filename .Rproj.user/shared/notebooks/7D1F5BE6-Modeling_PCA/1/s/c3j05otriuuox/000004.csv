"0","# Print kNN model summary"
"0","ensemble.models$knn"
"1","k-Nearest Neighbors"
"1"," "
"1","

"
"1","246"
"1",""
"1"," samples"
"1","
"
"1","  7"
"1",""
"1"," predictor"
"1",""
"1","
"
"1","
"
"1","Pre-processing: centered (7), scaled (7)"
"1"," "
"1","
"
"1","Resampling:"
"1"," "
"1","Cross-Validated (10 fold)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","221, 222, 221, 222, 222, 221, ..."
"1"," "
"1","
"
"1","Resampling results"
"1"," across tuning parameters"
"1",":

"
"1",""
"1","  k "
"1","  RMSE    "
"1","  Rsquared  "
"1","  MAE      "
"1","
"
"1","   5"
"1","  1.095632"
"1","  0.08289345"
"1","  0.6389863"
"1","
"
"1","   7"
"1","  1.099697"
"1","  0.05080179"
"1","  0.6478129"
"1","
"
"1","   9"
"1","  1.095010"
"1","  0.03837144"
"1","  0.6484233"
"1","
"
"1","  11"
"1","  1.084744"
"1","  0.03278807"
"1","  0.6288731"
"1","
"
"1","  13"
"1","  1.081373"
"1","  0.03914047"
"1","  0.6244824"
"1","
"
"1","  15"
"1","  1.073794"
"1","  0.05760648"
"1","  0.6188573"
"1","
"
"1","  17"
"1","  1.070625"
"1","  0.06005288"
"1","  0.6145598"
"1","
"
"1","  19"
"1","  1.077580"
"1","  0.04757898"
"1","  0.6178363"
"1","
"
"1","  21"
"1","  1.078646"
"1","  0.04796042"
"1","  0.6193779"
"1","
"
"1","  23"
"1","  1.080235"
"1","  0.04242322"
"1","  0.6200468"
"1","
"
"1","  25"
"1","  1.079717"
"1","  0.04149783"
"1","  0.6173809"
"1","
"
"1","  27"
"1","  1.072803"
"1","  0.05326838"
"1","  0.6150709"
"1","
"
"1","  29"
"1","  1.071514"
"1","  0.05248265"
"1","  0.6134723"
"1","
"
"1","  31"
"1","  1.071258"
"1","  0.05519706"
"1","  0.6133139"
"1","
"
"1","  33"
"1","  1.074527"
"1","  0.04573226"
"1","  0.6114621"
"1","
"
"1","  35"
"1","  1.072335"
"1","  0.05369971"
"1","  0.6078421"
"1","
"
"1","  37"
"1","  1.072503"
"1","  0.05093173"
"1","  0.6069605"
"1","
"
"1","  39"
"1","  1.072482"
"1","  0.05254741"
"1","  0.6071913"
"1","
"
"1","  41"
"1","  1.072883"
"1","  0.05328870"
"1","  0.6059066"
"1","
"
"1","  43"
"1","  1.073248"
"1","  0.04967071"
"1","  0.6059558"
"1","
"
"1","
"
"1","RMSE was used to select the optimal model using the smallest value.
"
"1","The final value used for the model was k = 17."
"1","
"
"0","# kNN cross-validation plot"
"0","knn.k <- ensemble.models$knn$results$k"
"0","knn.rmse <- ensemble.models$knn$results$RMSE"
"0","knn.mae <- ensemble.models$knn$results$MAE"
"0",""
"0","# Plot the RMSE and MAE in a facet plot using facet_wrap"
"0","p.knn.cv <- data.frame(k=knn.k, RMSE=knn.rmse, MAE=knn.mae) %>%"
"0","  pivot_longer(cols=c(RMSE, MAE), names_to=""Metric"", values_to=""Value"") %>%"
"0","  mutate(Metric = ifelse(Metric==""MAE"", ""Mean Absolute Error"", ""Root-Mean Square Error"")) %>%"
"0","  # One line per value of alpha"
"0","  ggplot(data=., mapping=aes(x=k, y=Value, color=Metric)) +"
"0","  # Facet the MAE and RMSE in separate plots"
"0","  facet_wrap(Metric ~ ., scales=""free"") +"
"0","  geom_point() +"
"0","  geom_line() +"
"0","  theme_minimal() +"
"0","  ggtitle(""kNN Regression Cross-Validated Results"") +"
"0","  theme(plot.title=element_text(hjust=0.5),"
"0","        axis.title=element_blank(),"
"0","        panel.spacing = unit(2, ""lines""))"
"0",""
"0","# Convert to interactive plotly"
"0","ggplotly(p.knn.cv) %>% "
"0","  layout(yaxis = list(title = ""MAE"", "
"0","                      titlefont = list(size = 12)),"
"0","         xaxis = list(title = ""k"", "
"0","                      titlefont = list(size = 12)),"
"0","         yaxis2 = list(title = ""RMSE"", "
"0","                       titlefont = list(size = 12)),"
"0","         xaxis2 = list(title = ""k"", "
"0","                       titlefont = list(size = 12)),"
"0","         autosize = F, width = 900, height = 400)"
